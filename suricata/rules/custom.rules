# Detecta accesos a un sitio específico conocido por pruebas de seguridad (testmynids.org).
alert http any any -> any any (msg:"HTTP Test My NIDS Detected"; content:"testmynids.org"; classtype:web-application-activity; sid:1001000; rev:1;)

# Detecta posibles ataques DDoS basados en una gran cantidad de paquetes hacia el puerto 8080 en un corto período de tiempo.
alert http any any -> any 8080 (msg: "Possible DDoS attack"; flow: stateless; threshold: type both, track by_dst, count 200, seconds 1; classtype:denial-of-service; sid:1001001; rev:1;)

# Detecta intentos de inyección SQL realizados por herramientas de explotación como Metasploit.
alert http any any -> any any (msg:"Metasploit SQL Injection Attempt Detected"; content:"SQL Error"; classtype:web-application-attack; sid:1001002; rev:1;)

# Detecta intentos de inyección SQL que contienen una comilla simple en la URI HTTP.
alert http any any -> any any (msg: "Possible SQL Injection attack (Contains singlequote)"; flow:established,to_server; content:"'"; nocase; http_uri; classtype:web-application-attack; sid:1001100; rev:1;)

# Detecta intentos de inyección SQL que contienen la palabra "UNION" en la URI HTTP.
alert http any any -> any any (msg: "Possible SQL Injection attack (Contains UNION)"; flow:established,to_server; content:"union"; nocase; http_uri; classtype:web-application-attack; sid:1001101; rev:1;)

# Detecta intentos de inyección SQL que contienen la palabra "SELECT" en la URI HTTP.
alert http any any -> any any (msg: "Possible SQL Injection attack (Contains SELECT)"; flow:established,to_server; content:"select"; nocase; http_uri; classtype:web-application-attack; sid:1001102; rev:1;)

# Detecta intentos de inyección SQL que contienen una comilla simple en los datos POST HTTP.
alert http any any -> any any (msg: "Possible SQL Injection attack (Contains singlequote POST DATA)"; flow:established,to_server; content:"'"; nocase; http_client_body; classtype:web-application-attack; sid:1001103; rev:1;)

# Detecta intentos de inyección SQL que contienen la palabra "UNION" en los datos POST HTTP.
alert http any any -> any any (msg: "Possible SQL Injection attack (Contains UNION POST DATA)"; flow:established,to_server; content:"union"; nocase; http_client_body; classtype:web-application-attack; sid:1001104; rev:1;)

# Detecta intentos de inyección SQL que contienen la palabra "SELECT" en los datos POST HTTP.
alert http any any -> any any (msg: "Possible SQL Injection attack (Contains SELECT POST DATA)"; flow:established,to_server; content:"select"; nocase; http_client_body; classtype:web-application-attack; sid:1001105; rev:1;)

# Detecta intentos de inyección de comandos utilizando un punto y coma (;) seguido de la ejecución de "cat /etc/passwd".
alert http any any -> any any (msg:"Command Injection Detected - Semicolon"; content:"\;"; http_client_body; content:"cat /etc/passwd"; nocase; classtype:web-application-attack; sid:1001200; rev:1;)

# Detecta intentos de inyección de comandos utilizando doble ampersand (&&) seguido de la ejecución de "cat /etc/passwd".
alert http any any -> any any (msg:"Command Injection Detected - Double Ampersand"; content:"&&"; http_client_body; content:"cat /etc/passwd"; nocase; classtype:web-application-attack; sid:1001201; rev:1;)

# Detecta intentos de inyección de comandos utilizando un pipe (|) seguido de la ejecución de "cat /etc/passwd".
alert http any any -> any any (msg:"Command Injection Detected - Pipe"; content:"\|"; http_client_body; content:"cat /etc/passwd"; nocase; classtype:web-application-attack; sid:1001202; rev:1;)

# Detecta accesos a archivos sensibles como "/etc/passwd" a través de datos POST HTTP.
alert http any any -> any any (msg:"Sensitive File Access Attempt - /etc/passwd"; content:"/etc/passwd"; http_client_body; nocase; classtype:sensitive-data-leak; sid:1001203; rev:1;)

# Detecta intentos de inyección de comandos para establecer un reverse shell utilizando "bash -i >& /dev/tcp/".
alert http any any -> any any (msg:"Possible Reverse Shell Command (Raw Payload)"; content:"bash -i >& /dev/tcp/"; http_client_body; nocase; classtype:web-application-attack; sid:1001204; rev:1;)
# Detecta intentos de shell inverso con contenido más genérico.
alert http any any -> any any (msg:"Possible Reverse Shell Command (Split Content)"; content:"bash"; http_client_body; content:"/dev/tcp"; nocase; classtype:web-application-attack; sid:1001205; rev:1;)
# Detecta intentos de shell inverso con datos codificados en URL.
#alert http any any -> any any (msg:"Possible Reverse Shell Command (Encoded Payload)"; pcre:"/bash.*%2Fdev%2Ftcp/"; http_client_body; classtype:web-application-attack; sid:1001206; rev:1;)
#alert http any any -> any any (msg:"POST Request Detected"; flow:established,to_server; http_method; content:"POST"; http_client_body; classtype:protocol-command-decode; sid:1001300; rev:1;)
alert http any any -> any any (msg:"Command Injection Detected - Double Ampersand"; content:"&&"; http_client_body; classtype:web-application-attack; sid:2000002; rev:1;)
alert http any any -> any any (msg:"Possible Reverse Shell Command"; content:"bash"; http_client_body; content:"/dev/tcp"; classtype:web-application-attack; sid:2000003; rev:1;)
#alert http any any -> any any (msg:"Possible Command Injection"; pcre:"/;|&&|\\||<|>/i"; http_client_body; classtype:web-application-attack; sid:2000004; rev:1;)



# Detecta intentos de fuerza bruta en la página de DVWA.
alert http any any -> any any (msg:"Brute Force Attempt Detected"; flow:established,to_server; content:"POST"; http_method; content:"/vulnerabilities/brute/"; classtype:web-application-attack; threshold:type both, track by_src, count 10, seconds 30; sid:1001300; rev:1;)

# Detecta intentos de Cross-Site Scripting (XSS) mediante el uso de etiquetas <script> en la URI de las solicitudes HTTP.
alert http any any -> any any (msg:"XSS Attempt Detected - Script Tag"; content:"<script>"; nocase; http_uri; classtype:web-application-attack; sid:1001400; rev:1;)

# Detecta intentos de Cross-Site Scripting (XSS) mediante el uso de manipuladores de eventos como "onerror=" en la URI de las solicitudes HTTP.
alert http any any -> any any (msg:"XSS Attempt Detected - Event Handler"; content:"onerror="; nocase; http_uri; classtype:web-application-attack; sid:1001401; rev:1;)

# Detecta intentos de traversal de directorios mediante el uso de la secuencia "../" en la URI de las solicitudes HTTP.
alert http any any -> any any (msg:"Directory Traversal Attempt Detected"; content:"../"; http_uri; classtype:web-application-attack; sid:1001500; rev:1;)

# Detecta intentos de inclusión local de archivos (Local File Inclusion, LFI) buscando la ruta "/etc/passwd" en la URI de las solicitudes HTTP.
alert http any any -> any any (msg:"Local File Inclusion Detected"; content:"/etc/passwd"; http_uri; classtype:web-application-attack; sid:1001501; rev:1;)

# Detecta posibles intentos de comandos de reverse shell en el cuerpo de las solicitudes HTTP.
alert http any any -> any any (msg:"Possible Reverse Shell Command"; content:"bash -i >& /dev/tcp/"; http_client_body; nocase; classtype:web-application-attack; sid:1001502; rev:1;)
